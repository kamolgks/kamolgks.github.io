document.addEventListener("DOMContentLoaded",()=>{let e={en:{name:"English"},ru:{name:"Русский"},uz:{name:"O'zbekcha"}},t=localStorage.getItem("language")||"en",n={},a=document.querySelector(".theme-btn"),l=document.querySelector(".nav-toggle"),o=document.querySelector(".nav-links"),i=document.querySelector(".lang-switch"),r=document.querySelector(".lang-btn"),s=document.querySelector(".lang-dropdown"),d=document.querySelector(".typing-text"),c=()=>{g(localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"))},g=e=>{document.documentElement.setAttribute("data-theme",e),localStorage.setItem("theme",e),a&&(a.querySelector("i").className="dark"===e?"fas fa-moon":"fas fa-sun")};a&&a.addEventListener("click",()=>{g("dark"===document.documentElement.getAttribute("data-theme")?"light":"dark")}),l&&o&&(l.addEventListener("click",()=>o.classList.toggle("show")),o.addEventListener("click",e=>{e.target.closest("a")&&o.classList.remove("show")}));let m=document.querySelectorAll("section[id]"),u=document.querySelectorAll(".nav-links a"),h=()=>{let e="";m.forEach(t=>{let n=t.offsetTop;window.scrollY>=n-70&&(e=t.getAttribute("id"))}),u.forEach(t=>{t.classList.remove("active"),t.getAttribute("href")===`#${e}`&&t.classList.add("active")})},y=()=>{document.querySelectorAll(".progress").forEach(e=>{let t=e.getBoundingClientRect();t.top<window.innerHeight&&t.bottom>=0&&(e.style.width=e.getAttribute("data-width"))})};window.addEventListener("scroll",()=>{h(),y()});let f=async e=>{try{let t=await fetch(`assets/locales/lang_${e}.json`);if(!t.ok)throw Error(`Translation file for ${e} not found.`);n=await t.json()}catch(a){console.error("Error loading translation:",a),n={}}},p=()=>{document.querySelectorAll("[data-lang-key]").forEach(e=>{let t=n[e.getAttribute("data-lang-key")];t&&(e.textContent=t)}),L()},$=async e=>{e&&e!==t&&(t=e,localStorage.setItem("language",e),await f(e),p(),v(e))},v=e=>{r&&(r.querySelector(".current-lang").textContent=e.toUpperCase())},E=()=>{i&&s&&(s.innerHTML="",Object.keys(e).forEach(t=>{let n=e[t],a=document.createElement("div");a.className="lang-option",a.textContent=n.name,a.addEventListener("click",e=>{e.stopPropagation(),$(t),s.classList.remove("show")}),s.appendChild(a)}),r.addEventListener("click",e=>{e.stopPropagation(),s.classList.toggle("show")}),document.addEventListener("click",()=>{s.classList.remove("show")}),v(t))},w=null,k=(e,t=0,n=0,a=!1)=>{if(!d||0===e.length)return;clearTimeout(w);let l=e[t];a?(d.textContent=l.substring(0,n-1),n--):(d.textContent=l.substring(0,n+1),n++);let o=a?50:150;a||n!==l.length?a&&0===n&&(a=!1,t=(t+1)%e.length,o=500):(a=!0,o=2e3),w=setTimeout(()=>k(e,t,n,a),o)},L=()=>{clearTimeout(w);let e=n["hero.animatedTexts"]||[];d&&(d.textContent="",k(e))};(async()=>{c(),E(),await f(t),p(),h(),y(),AOS.init({duration:600,offset:100,once:!0,easing:"ease-out-cubic"})})()});