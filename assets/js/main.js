document.addEventListener("DOMContentLoaded",()=>{let e={en:{name:"English"},ru:{name:"Русский"},uz:{name:"O'zbekcha"}},t=localStorage.getItem("language")||"en",a={},n=document.querySelector(".theme-btn"),l=document.querySelector(".nav-toggle"),r=document.querySelector(".nav-links"),o=document.querySelector(".lang-switch"),s=document.querySelector(".lang-btn"),i=document.querySelector(".lang-dropdown"),c=document.querySelector(".typing-text"),d=()=>{let e=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");g(e)},g=e=>{document.documentElement.setAttribute("data-theme",e),localStorage.setItem("theme",e),n&&(n.querySelector("i").className="dark"===e?"fas fa-moon":"fas fa-sun")};n&&n.addEventListener("click",()=>{let e=document.documentElement.getAttribute("data-theme");g("dark"===e?"light":"dark")}),l&&r&&(l.addEventListener("click",()=>r.classList.toggle("show")),r.addEventListener("click",e=>{e.target.closest("a")&&r.classList.remove("show")}));let u=document.querySelectorAll("section[id]"),h=document.querySelectorAll(".nav-links a"),m=()=>{let e="";u.forEach(t=>{let a=t.offsetTop;window.scrollY>=a-70&&(e=t.getAttribute("id"))}),h.forEach(t=>{t.classList.remove("active"),t.getAttribute("href")===`#${e}`&&t.classList.add("active")})},y=()=>{let e=document.querySelectorAll(".progress");e.forEach(e=>{let t=e.getBoundingClientRect();t.top<window.innerHeight&&t.bottom>=0&&(e.style.width=e.getAttribute("data-width"))})};window.addEventListener("scroll",()=>{m(),y()});let $=async e=>{try{let t=await fetch(`assets/locales/lang_${e}.json`);if(!t.ok)throw Error(`Translation file for ${e} not found.`);a=await t.json()}catch(n){console.error("Error loading translation:",n),a={}}},f=()=>{document.querySelectorAll("[data-lang-key]").forEach(e=>{let t=e.getAttribute("data-lang-key"),n=a[t];n&&(e.textContent=n)}),w()},k=async e=>{e&&e!==t&&(t=e,localStorage.setItem("language",e),await $(e),f(),v(e))},v=e=>{s&&(s.querySelector(".current-lang").textContent=e.toUpperCase())},E=()=>{o&&i&&(i.innerHTML="",Object.keys(e).forEach(t=>{let a=e[t],n=document.createElement("div");n.className="lang-option",n.textContent=a.name,n.addEventListener("click",e=>{e.stopPropagation(),k(t),i.classList.remove("show")}),i.appendChild(n)}),s.addEventListener("click",e=>{e.stopPropagation(),i.classList.toggle("show")}),document.addEventListener("click",()=>{i.classList.remove("show")}),v(t))},L=null,p=(e,t=0,a=0,n=!1)=>{if(!c||0===e.length)return;clearTimeout(L);let l=e[t];n?(c.textContent=l.substring(0,a-1),a--):(c.textContent=l.substring(0,a+1),a++);let r=n?50:150;n||a!==l.length?n&&0===a&&(n=!1,t=(t+1)%e.length,r=500):(n=!0,r=2e3),L=setTimeout(()=>p(e,t,a,n),r)},w=()=>{clearTimeout(L);let e=a["hero.animatedTexts"]||[];c&&(c.textContent="",p(e))},b=async()=>{d(),E(),await $(t),f(),m(),y(),AOS.init({duration:600,offset:100,once:!0,easing:"ease-out-cubic"})};b()});